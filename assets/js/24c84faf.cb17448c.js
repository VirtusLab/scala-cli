"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1318],{9705:function(e,a,t){t.d(a,{m:function(){return o},v:function(){return s}});var l=t(7294),n=t(2004);function s(e){var a=e.children;return l.createElement("div",{className:"runnable-command"},a)}function o(e){var a=e.url;return l.createElement(n.Z,{playing:!0,loop:!0,muted:!0,controls:!0,width:"100%",height:"",url:a})}},5950:function(e,a,t){t.r(a),t.d(a,{assets:function(){return c},contentTitle:function(){return p},default:function(){return k},frontMatter:function(){return r},metadata:function(){return d},toc:function(){return m}});var l=t(3117),n=t(102),s=(t(7294),t(3905)),o=t(9705),i=["components"],r={title:"Scala.js",sidebar_position:40},p=void 0,d={unversionedId:"guides/scala-js",id:"guides/scala-js",title:"Scala.js",description:"Scala CLI can compile, run, test, and package Scala.js sources.",source:"@site/docs/guides/scala-js.md",sourceDirName:"guides",slug:"/guides/scala-js",permalink:"/docs/guides/scala-js",draft:!1,editUrl:"https://github.com/Virtuslab/scala-cli/edit/main/website/docs/guides/scala-js.md",tags:[],version:"current",sidebarPosition:40,frontMatter:{title:"Scala.js",sidebar_position:40},sidebar:"tutorialSidebar",previous:{title:"Shebang",permalink:"/docs/guides/shebang"},next:{title:"Scala Native",permalink:"/docs/guides/scala-native"}},c={},m=[{value:"Configuration",id:"configuration",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Package",id:"package",level:2},{value:"Module Split Style",id:"module-split-style",level:3},{value:"Smallest Modules",id:"smallest-modules",level:3},{value:"Small Modules For",id:"small-modules-for",level:3},{value:"Emit source maps",id:"emit-source-maps",level:2},{value:"Scala.js DOM support",id:"scalajs-dom-support",level:2},{value:"Using Directives",id:"using-directives",level:2},{value:"<code>--js-version</code>",id:"--js-version",level:4},{value:"<code>--js-header</code>",id:"--js-header",level:4},{value:"Supported Scala.js Versions",id:"supported-scalajs-versions",level:2}],u={toc:m};function k(e){var a=e.components,t=(0,n.Z)(e,i);return(0,s.kt)("wrapper",(0,l.Z)({},u,t,{components:a,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"Scala CLI can compile, run, test, and package Scala.js sources."),(0,s.kt)("p",null,"One caveat is that Scala CLI doesn't have support for JS bundlers (such as ",(0,s.kt)("a",{parentName:"p",href:"https://webpack.js.org"},"webpack"),")\nlike ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/scalacenter/scalajs-bundler"},"scalajs-bundler")," has.\nFor this, you'll have to handle bundling yourself, with the ",(0,s.kt)("inlineCode",{parentName:"p"},".js")," file generated by Scala CLI."),(0,s.kt)("p",null,"In order to run Scala.js sources, ",(0,s.kt)("inlineCode",{parentName:"p"},"node")," is required."),(0,s.kt)("h2",{id:"configuration"},"Configuration"),(0,s.kt)("p",null,"Enable Scala.js support by passing ",(0,s.kt)("inlineCode",{parentName:"p"},"--js")," to Scala CLI, such as:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash",metastring:"ignore",ignore:!0},"scala-cli Test.scala --js\n")),(0,s.kt)("h2",{id:"dependencies"},"Dependencies"),(0,s.kt)("p",null,"This section is currently a work in progress, but here are some initial notes:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Beware platform dependencies"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"run")," / ",(0,s.kt)("inlineCode",{parentName:"li"},"test")," / ",(0,s.kt)("inlineCode",{parentName:"li"},"package")," should all work")),(0,s.kt)("h2",{id:"package"},"Package"),(0,s.kt)("p",null,"Packaging Scala.js applications results in a ",(0,s.kt)("inlineCode",{parentName:"p"},".js")," file, that can be run with ",(0,s.kt)("inlineCode",{parentName:"p"},"node"),":"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=HelloJs.scala",title:"HelloJs.scala"},'import scala.scalajs.js\n\nobject Hello {\n  def main(args: Array[String]): Unit = {\n    val console = js.Dynamic.global.console\n    val msg = "Hello World from Scala.js"\n    console.log(msg)\n  }\n}\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli --power package --js HelloJs.scala -o hello.js\nnode hello.js\n# Hello World from Scala.js\n")),(0,s.kt)("h3",{id:"module-split-style"},"Module Split Style"),(0,s.kt)("h3",{id:"smallest-modules"},"Smallest Modules"),(0,s.kt)("p",null,"Passing ",(0,s.kt)("inlineCode",{parentName:"p"},"--js-module-split-style smallestmodules")," to the ",(0,s.kt)("inlineCode",{parentName:"p"},"package")," sub-command creates js modules that are as small as possible.\nScala.js linker generates a lot of js modules, which are copied to the ",(0,s.kt)("inlineCode",{parentName:"p"},"output")," directory."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=SmallestModules.scala",title:"SmallestModules.scala"},'import scala.scalajs.js\n\ncase class Foo(txt: String)\n\nobject Hello extends App {\n  println(Foo("Hello World from Scala.js").txt)\n}\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},'scala-cli --power package --js SmallestModules.scala --js-module-split-style smallestmodules --js-module-kind es --output hello\necho "{\\"type\\": \\"module\\"}" >> package.json # enable ES module\nnode hello/main.js\n# Hello World from Scala.js\n')),(0,s.kt)("h3",{id:"small-modules-for"},"Small Modules For"),(0,s.kt)("p",null,"Passing ",(0,s.kt)("inlineCode",{parentName:"p"},"--js-module-split-style smallestmodules")," to the ",(0,s.kt)("inlineCode",{parentName:"p"},"package")," sub-command creates many small modules as possibles for the classes in the listed packages (and their subpackages). To define packages use ",(0,s.kt)("inlineCode",{parentName:"p"},"jsSmallModuleForPackage")," parameter."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=SmallestModules.scala",title:"SmallestModules.scala"},'//> using jsModuleKind "es"\n//> using jsModuleSplitStyleStr "smallmodulesfor"\n//> using jsSmallModuleForPackage "com.example.test", "com.example.example""\n\npackage com.example.test\n\nimport scala.scalajs.js\n\ncase class Foo(txt: String)\n\nobject Hello extends App {\n  println(Foo("Hello World from Scala.js").txt)\n}\n')),(0,s.kt)("h2",{id:"emit-source-maps"},"Emit source maps"),(0,s.kt)("p",null,"Passing ",(0,s.kt)("inlineCode",{parentName:"p"},"--js-emit-source-maps")," to the ",(0,s.kt)("inlineCode",{parentName:"p"},"package")," sub-command emits source maps alongside js files. To set the destination path of source maps, pass ",(0,s.kt)("inlineCode",{parentName:"p"},"--js-source-maps-path")," flag with the argument."),(0,s.kt)("p",null,"The following command emits a ",(0,s.kt)("inlineCode",{parentName:"p"},"main.js.map")," alongside js files:"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=sample.sc",title:"sample.sc"},'println("sample")\n')),(0,s.kt)(o.v,{mdxType:"ChainedSnippets"},(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli --power package sample.sc --js --js-emit-source-maps\n")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-text"},"Emitted js source maps to: ./Hello.js.map\nWrote Hello.js, run it with\n node ./Hello.js\n"))),(0,s.kt)("h2",{id:"scalajs-dom-support"},"Scala.js DOM support"),(0,s.kt)("p",null,"Pass ",(0,s.kt)("inlineCode",{parentName:"p"},"--js-dom")," to ",(0,s.kt)("inlineCode",{parentName:"p"},"compile"),", ",(0,s.kt)("inlineCode",{parentName:"p"},"run"),", or ",(0,s.kt)("inlineCode",{parentName:"p"},"test")," to simulate a DOM in Node.js"),(0,s.kt)("admonition",{type:"note"},(0,s.kt)("p",{parentName:"admonition"},"If you see the following error, it means that you don't have the ",(0,s.kt)("inlineCode",{parentName:"p"},"jsdom")," library installed to simulate the DOM."),(0,s.kt)("pre",{parentName:"admonition"},(0,s.kt)("code",{parentName:"pre"},"Error: Cannot find module 'jsdom'\n")),(0,s.kt)("p",{parentName:"admonition"},"To fix it, install ",(0,s.kt)("inlineCode",{parentName:"p"},"jsdom")," locally for your project. You can install install ",(0,s.kt)("inlineCode",{parentName:"p"},"jsdom")," as follows:"),(0,s.kt)("pre",{parentName:"admonition"},(0,s.kt)("code",{parentName:"pre"},"npm init private\nnpm install jsdom\n"))),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=Hello.scala",title:"Hello.scala"},'//> using dep "org.scala-js::scalajs-dom::2.1.0"\n//> using platform scala-js\n\nobject Hello {\n  def main(args: Array[String]): Unit = {\n      val parNode = document.createElement("p")\n      parNode.textContent = "Hello World"\n      document.body.appendChild(parNode)\n  }\n}\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli sample.sc --js-dom\n")),(0,s.kt)("h2",{id:"using-directives"},"Using Directives"),(0,s.kt)("p",null,"Scala.js options are supported by using directives in Scala CLI:"),(0,s.kt)("h4",{id:"--js-version"},(0,s.kt)("inlineCode",{parentName:"h4"},"--js-version")),(0,s.kt)("p",null," The Scala.js version"),(0,s.kt)("h4",{id:"--js-header"},(0,s.kt)("inlineCode",{parentName:"h4"},"--js-header")),(0,s.kt)("p",null," A header that will be added at the top of generated .js files"),(0,s.kt)("p",null,"For more options, see our ",(0,s.kt)("a",{parentName:"p",href:"/docs/reference/directives#scala-js-options"},(0,s.kt)("inlineCode",{parentName:"a"},"using")," directive section"),"."),(0,s.kt)("h2",{id:"supported-scalajs-versions"},"Supported Scala.js Versions"),(0,s.kt)("p",null,"In the future, the Scala CLI will be able to support any version of Scala.js independently of the version of scala-cli. But for now, there are some limitations and it isn't possible to use each version of Scala.js."),(0,s.kt)("p",null,"The table below lists the last supported version of Scala.js in Scala CLI. If you want to use newer Scala.js, update scala-cli."),(0,s.kt)("table",null,(0,s.kt)("thead",{parentName:"table"},(0,s.kt)("tr",{parentName:"thead"},(0,s.kt)("th",{parentName:"tr",align:null},"Scala CLI versions"),(0,s.kt)("th",{parentName:"tr",align:"center"},"Scala.js"))),(0,s.kt)("tbody",{parentName:"table"},(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"0.0.9"),(0,s.kt)("td",{parentName:"tr",align:"center"},"1.7.1")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"0.1.0 - 0.1.2"),(0,s.kt)("td",{parentName:"tr",align:"center"},"1.8.0")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"0.1.3"),(0,s.kt)("td",{parentName:"tr",align:"center"},"1.9.0")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"0.1.4 - 0.1.8"),(0,s.kt)("td",{parentName:"tr",align:"center"},"1.10.0")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"0.1.9 - 0.1.17"),(0,s.kt)("td",{parentName:"tr",align:"center"},"1.10.1")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"0.1.18 - 0.2.0"),(0,s.kt)("td",{parentName:"tr",align:"center"},"1.12.0")),(0,s.kt)("tr",{parentName:"tbody"},(0,s.kt)("td",{parentName:"tr",align:null},"0.2.1 - current"),(0,s.kt)("td",{parentName:"tr",align:"center"},"1.13.0")))))}k.isMDXComponent=!0}}]);