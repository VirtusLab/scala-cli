"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3462],{4106:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>o});var s=i(4848),t=i(8453);const c={title:"Fix \u26a1\ufe0f",sidebar_position:28},l=void 0,a={id:"commands/fix",title:"Fix \u26a1\ufe0f",description:"The Fix command is experimental and requires setting the --power option to be used.",source:"@site/docs/commands/fix.md",sourceDirName:"commands",slug:"/commands/fix",permalink:"/docs/commands/fix",draft:!1,unlisted:!1,editUrl:"https://github.com/Virtuslab/scala-cli/edit/main/website/docs/commands/fix.md",tags:[],version:"current",sidebarPosition:28,frontMatter:{title:"Fix \u26a1\ufe0f",sidebar_position:28},sidebar:"tutorialSidebar",previous:{title:"Export \u26a1\ufe0f",permalink:"/docs/commands/export"},next:{title:"Package \u26a1\ufe0f",permalink:"/docs/commands/package"}},r={},o=[{value:"Built-in rules",id:"built-in-rules",level:2},{value:"<code>scalafix</code> integration",id:"scalafix-integration",level:2},{value:"Using external rules",id:"using-external-rules",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.admonition,{type:"caution",children:[(0,s.jsxs)(n.p,{children:["The Fix command is experimental and requires setting the ",(0,s.jsx)(n.code,{children:"--power"})," option to be used.\nYou can pass it explicitly or set it globally by running:"]}),(0,s.jsx)(n.p,{children:"scala-cli config power true"})]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"fix"})," command is used to check, lint, rewrite or otherwise rearrange code in a Scala CLI project."]}),"\n",(0,s.jsx)(n.p,{children:"Currently, the following sets of rules are supported:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["built-in rules (enabled automatically and controlled with the ",(0,s.jsx)(n.code,{children:"--enable-built-in"})," flag)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"scalafix"}),", running ",(0,s.jsx)(n.a,{href:"https://scalacenter.github.io/scalafix/",children:"Scalafix"})," under the hood (enabled automatically and controlled with ",(0,s.jsx)(n.code,{children:"--enable-scalafix"})," flag)."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"You can disable unnecessary rule sets when needed.\nFor example, to disable built-in rules, you can run:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"scala-cli fix . --power --enable-built-in=false\n"})}),"\n",(0,s.jsx)(n.h2,{id:"built-in-rules",children:"Built-in rules"}),"\n",(0,s.jsxs)(n.p,{children:["Currently, the only built-in rule is extraction of ",(0,s.jsx)(n.code,{children:"using"})," directives into the ",(0,s.jsx)(n.code,{children:"project.scala"})," configuration file.\nThis allows to fix warnings tied to having ",(0,s.jsx)(n.code,{children:"using"})," directives present in multiple files and eliminate duplicate directives.\nFiles containing (experimental) ",(0,s.jsx)(n.code,{children:"using target"})," directives, e.g. ",(0,s.jsx)(n.code,{children:"//> using target.scala 3.0.0"})," will not be changed by ",(0,s.jsx)(n.code,{children:"fix"}),".\nThe original scope (",(0,s.jsx)(n.code,{children:"main"})," or ",(0,s.jsx)(n.code,{children:"test"}),") of each extracted directive is respected. ",(0,s.jsx)(n.code,{children:"main"})," scope directives are transformed\nthem into their ",(0,s.jsx)(n.code,{children:"test.*"})," equivalent when needed."]}),"\n",(0,s.jsx)(n.p,{children:"Exceptions:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"directives won't be extracted for single-file projects;"}),"\n",(0,s.jsx)(n.li,{children:"directives in test inputs with no test scope equivalents won't be extracted to preserve their initial scope."}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"scalafix-integration",children:[(0,s.jsx)(n.code,{children:"scalafix"})," integration"]}),"\n",(0,s.jsxs)(n.p,{children:["Scala CLI is capable of running ",(0,s.jsx)(n.a,{href:"https://scalacenter.github.io/scalafix/",children:"Scalafix"})," (a refactoring and linting tool for Scala) on your project.\nBefore using this command you need to provide the configuration at ",(0,s.jsx)(n.code,{children:".scalafix.conf"}),".\nFor example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",metastring:"title=.scalafix.conf",children:"// .scalafix.conf\nrules = [\n  DisableSyntax\n]\n"})}),"\n",(0,s.jsx)(n.p,{children:"Then you can run it:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"scala-cli fix . --power\n"})}),"\n",(0,s.jsxs)(n.p,{children:["If you\u2019re setting up a continuous integration (CI) server, Scala CLI also has you covered.\nYou can run linter using the ",(0,s.jsx)(n.code,{children:"--check"})," flag:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",metastring:"fail",children:"scala-cli fix --check . --power\n"})}),"\n",(0,s.jsx)(n.p,{children:"Read more about Scalafix:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://scalacenter.github.io/scalafix/docs/users/configuration.html",children:"Configuration"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://scalacenter.github.io/scalafix/docs/rules/overview.html",children:"Rules"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"using-external-rules",children:"Using external rules"}),"\n",(0,s.jsxs)(n.p,{children:["Adding an ",(0,s.jsx)(n.a,{href:"https://scalacenter.github.io/scalafix/docs/rules/external-rules.html",children:"external scalafix rule"})," to Scala CLI can be done with the ",(0,s.jsx)(n.a,{href:"/docs/commands/compile#compile-only-dependencies",children:(0,s.jsx)(n.code,{children:"scalafix.dep"})})," directive:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-scala",metastring:"compile power",children:"//> using scalafix.dep com.github.xuwei-k::scalafix-rules:0.5.1\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(6540);const t={},c=s.createContext(t);function l(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);