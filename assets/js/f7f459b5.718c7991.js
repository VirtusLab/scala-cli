"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4407],{5847:(e,s,l)=>{l.r(s),l.d(s,{assets:()=>r,contentTitle:()=>t,default:()=>j,frontMatter:()=>c,metadata:()=>d,toc:()=>o});var n=l(5893),a=l(1151),i=l(9705);const c={title:"Scala.js",sidebar_position:40},t=void 0,d={id:"guides/advanced/scala-js",title:"Scala.js",description:"Scala CLI can compile, run, test, and package Scala.js sources.",source:"@site/docs/guides/advanced/scala-js.md",sourceDirName:"guides/advanced",slug:"/guides/advanced/scala-js",permalink:"/docs/guides/advanced/scala-js",draft:!1,unlisted:!1,editUrl:"https://github.com/Virtuslab/scala-cli/edit/main/website/docs/guides/advanced/scala-js.md",tags:[],version:"current",sidebarPosition:40,frontMatter:{title:"Scala.js",sidebar_position:40},sidebar:"tutorialSidebar",previous:{title:"Shebang",permalink:"/docs/guides/scripting/shebang"},next:{title:"Scala Native",permalink:"/docs/guides/advanced/scala-native"}},r={},o=[{value:"Configuration",id:"configuration",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"Package",id:"package",level:2},{value:"Module Split Style",id:"module-split-style",level:3},{value:"Smallest Modules",id:"smallest-modules",level:3},{value:"Small Modules For",id:"small-modules-for",level:3},{value:"Emit source maps",id:"emit-source-maps",level:2},{value:"Scala.js DOM support",id:"scalajs-dom-support",level:2},{value:"Using Directives",id:"using-directives",level:2},{value:"<code>--js-version</code>",id:"--js-version",level:4},{value:"<code>--js-header</code>",id:"--js-header",level:4},{value:"Supported Scala.js Versions",id:"supported-scalajs-versions",level:2}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.p,{children:"Scala CLI can compile, run, test, and package Scala.js sources."}),"\n",(0,n.jsxs)(s.p,{children:["One caveat is that Scala CLI doesn't have support for JS bundlers (such as ",(0,n.jsx)(s.a,{href:"https://webpack.js.org",children:"webpack"}),")\nlike ",(0,n.jsx)(s.a,{href:"https://github.com/scalacenter/scalajs-bundler",children:"scalajs-bundler"})," has.\nFor this, you'll have to handle bundling yourself, with the ",(0,n.jsx)(s.code,{children:".js"})," file generated by Scala CLI."]}),"\n",(0,n.jsxs)(s.p,{children:["In order to run Scala.js sources, ",(0,n.jsx)(s.code,{children:"node"})," is required."]}),"\n",(0,n.jsx)(s.h2,{id:"configuration",children:"Configuration"}),"\n",(0,n.jsxs)(s.p,{children:["Enable Scala.js support by passing ",(0,n.jsx)(s.code,{children:"--js"})," to Scala CLI, such as:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",metastring:"ignore",children:"scala-cli Test.scala --js\n"})}),"\n",(0,n.jsx)(s.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,n.jsx)(s.p,{children:"This section is currently a work in progress, but here are some initial notes:"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"Beware platform dependencies"}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"run"})," / ",(0,n.jsx)(s.code,{children:"test"})," / ",(0,n.jsx)(s.code,{children:"package"})," should all work"]}),"\n"]}),"\n",(0,n.jsx)(s.h2,{id:"package",children:"Package"}),"\n",(0,n.jsxs)(s.p,{children:["Packaging Scala.js applications results in a ",(0,n.jsx)(s.code,{children:".js"})," file, that can be run with ",(0,n.jsx)(s.code,{children:"node"}),":"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scala",metastring:"title=HelloJs.scala",children:'import scala.scalajs.js\n\nobject Hello {\n  def main(args: Array[String]): Unit = {\n    val console = js.Dynamic.global.console\n    val msg = "Hello World from Scala.js"\n    console.log(msg)\n  }\n}\n'})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"scala-cli --power package --js HelloJs.scala -o hello.js\nnode hello.js\n# Hello World from Scala.js\n"})}),"\n",(0,n.jsx)(s.h3,{id:"module-split-style",children:"Module Split Style"}),"\n",(0,n.jsx)(s.h3,{id:"smallest-modules",children:"Smallest Modules"}),"\n",(0,n.jsxs)(s.p,{children:["Passing ",(0,n.jsx)(s.code,{children:"--js-module-split-style smallestmodules"})," to the ",(0,n.jsx)(s.code,{children:"package"})," sub-command creates js modules that are as small as possible.\nScala.js linker generates a lot of js modules, which are copied to the ",(0,n.jsx)(s.code,{children:"output"})," directory."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scala",metastring:"title=SmallestModules.scala",children:'import scala.scalajs.js\n\ncase class Foo(txt: String)\n\nobject Hello extends App {\n  println(Foo("Hello World from Scala.js").txt)\n}\n'})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:'scala-cli --power package --js SmallestModules.scala --js-module-split-style smallestmodules --js-module-kind es --output hello\necho "{\\"type\\": \\"module\\"}" >> package.json # enable ES module\nnode hello/main.js\n# Hello World from Scala.js\n'})}),"\n",(0,n.jsx)(s.h3,{id:"small-modules-for",children:"Small Modules For"}),"\n",(0,n.jsxs)(s.p,{children:["Passing ",(0,n.jsx)(s.code,{children:"--js-module-split-style smallestmodules"})," to the ",(0,n.jsx)(s.code,{children:"package"})," sub-command creates many small modules as possibles for the classes in the listed packages (and their subpackages). To define packages use ",(0,n.jsx)(s.code,{children:"jsSmallModuleForPackage"})," parameter."]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scala",metastring:"title=SmallestModules.scala",children:'//> using jsModuleKind es\n//> using jsModuleSplitStyleStr smallmodulesfor\n//> using jsSmallModuleForPackage com.example.test com.example.example\n\npackage com.example.test\n\nimport scala.scalajs.js\n\ncase class Foo(txt: String)\n\nobject Hello extends App {\n  println(Foo("Hello World from Scala.js").txt)\n}\n'})}),"\n",(0,n.jsx)(s.h2,{id:"emit-source-maps",children:"Emit source maps"}),"\n",(0,n.jsxs)(s.p,{children:["Passing ",(0,n.jsx)(s.code,{children:"--js-emit-source-maps"})," to the ",(0,n.jsx)(s.code,{children:"package"})," sub-command emits source maps alongside js files. To set the destination path of source maps, pass ",(0,n.jsx)(s.code,{children:"--js-source-maps-path"})," flag with the argument."]}),"\n",(0,n.jsxs)(s.p,{children:["The following command emits a ",(0,n.jsx)(s.code,{children:"main.js.map"})," alongside js files:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scala",metastring:"title=sample.sc",children:'println("sample")\n'})}),"\n",(0,n.jsxs)(i.v,{children:[(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"scala-cli --power package sample.sc --js --js-emit-source-maps\n"})}),(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-text",children:"Emitted js source maps to: ./Hello.js.map\nWrote Hello.js, run it with\n node ./Hello.js\n"})})]}),"\n",(0,n.jsx)(s.h2,{id:"scalajs-dom-support",children:"Scala.js DOM support"}),"\n",(0,n.jsxs)(s.p,{children:["Pass ",(0,n.jsx)(s.code,{children:"--js-dom"})," to ",(0,n.jsx)(s.code,{children:"compile"}),", ",(0,n.jsx)(s.code,{children:"run"}),", or ",(0,n.jsx)(s.code,{children:"test"})," to simulate a DOM in Node.js"]}),"\n",(0,n.jsxs)(s.admonition,{type:"note",children:[(0,n.jsxs)(s.p,{children:["If you see the following error, it means that you don't have the ",(0,n.jsx)(s.code,{children:"jsdom"})," library installed to simulate the DOM."]}),(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"Error: Cannot find module 'jsdom'\n"})}),(0,n.jsxs)(s.p,{children:["To fix it, install ",(0,n.jsx)(s.code,{children:"jsdom"})," locally for your project. You can install install ",(0,n.jsx)(s.code,{children:"jsdom"})," as follows:"]}),(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"npm init private\nnpm install jsdom\n"})})]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-scala",metastring:"title=Hello.scala",children:'//> using dep org.scala-js::scalajs-dom::2.1.0\n//> using platform scala-js\n\nobject Hello {\n  def main(args: Array[String]): Unit = {\n      val parNode = document.createElement("p")\n      parNode.textContent = "Hello World"\n      document.body.appendChild(parNode)\n  }\n}\n'})}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-bash",children:"scala-cli sample.sc --js-dom\n"})}),"\n",(0,n.jsx)(s.h2,{id:"using-directives",children:"Using Directives"}),"\n",(0,n.jsx)(s.p,{children:"Scala.js options are supported by using directives in Scala CLI:"}),"\n",(0,n.jsx)(s.h4,{id:"--js-version",children:(0,n.jsx)(s.code,{children:"--js-version"})}),"\n",(0,n.jsx)(s.p,{children:"The Scala.js version"}),"\n",(0,n.jsx)(s.h4,{id:"--js-header",children:(0,n.jsx)(s.code,{children:"--js-header"})}),"\n",(0,n.jsx)(s.p,{children:"A header that will be added at the top of generated .js files"}),"\n",(0,n.jsxs)(s.p,{children:["For more options, see our ",(0,n.jsxs)(s.a,{href:"/docs/reference/directives#scalajs-options",children:[(0,n.jsx)(s.code,{children:"using"})," directive section"]}),"."]}),"\n",(0,n.jsx)(s.h2,{id:"supported-scalajs-versions",children:"Supported Scala.js Versions"}),"\n",(0,n.jsx)(s.p,{children:"In the future, the Scala CLI will be able to support any version of Scala.js independently of the version of scala-cli. But for now, there are some limitations and it isn't possible to use each version of Scala.js."}),"\n",(0,n.jsx)(s.p,{children:"The table below lists the last supported version of Scala.js in Scala CLI. If you want to use newer Scala.js, update scala-cli."}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Scala CLI versions"}),(0,n.jsx)(s.th,{style:{textAlign:"center"},children:"Scala.js"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"0.0.9"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.7.1"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"0.1.0 - 0.1.2"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.8.0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"0.1.3"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.9.0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"0.1.4 - 0.1.8"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.10.0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"0.1.9 - 0.1.17"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.10.1"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"0.1.18 - 0.2.0"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.12.0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"0.2.1 - 1.0.0-RC1"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.13.0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"1.0.0-RC2 - 1.0.2"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.13.1"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"1.0.3 - 1.0.4"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.13.2"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"1.0.5 - 1.1.1"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.14.0"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"1.1.2 - current"}),(0,n.jsx)(s.td,{style:{textAlign:"center"},children:"1.15.0"})]})]})]})]})}function j(e={}){const{wrapper:s}={...(0,a.a)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},9705:(e,s,l)=>{l.d(s,{m:()=>c,v:()=>i});l(7294);var n=l(2004),a=l(5893);function i(e){let{children:s}=e;return(0,a.jsx)("div",{className:"runnable-command",children:s})}function c(e){let{url:s}=e;return(0,a.jsx)(n.Z,{playing:!0,loop:!0,muted:!0,controls:!0,width:"100%",height:"",url:s})}}}]);